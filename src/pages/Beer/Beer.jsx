import { useState, useEffect} from 'react'
import { useParams } from 'react-router-dom' /* lavora con il router, restituisce un oggetto (coppia chiave valore) dei parametri dinamici dell'url abbinati al router path */
import { Brewscard } from '../../components/BreweriesCard/Brewscard'
import { BackButton } from '../../components/BackButton/BackButton'

import './Beer.css'

export const Beer = () => {
    const [beer, setBeer] = useState()
    const params = useParams()

    useEffect(() => {
        const getBeer = async () => {
            const response = await fetch(`http://localhost:1337/api/beers/${params.id}?populate=*`)
            const {data} = await response.json()

            setBeer(data)
            console.log(data);
        }

        return getBeer
    }, []) 
    // console.log(beer)
    return(
        <main>
            <BackButton url="/beers" />
            {beer &&
            <>
                <div className="beer-cover">
                    <h1>{beer.attributes.name}</h1>
                    <h2>{beer.attributes.type}</h2>

                    <div className='beer-info'>
                        <h2 className='tac'>{beer.attributes.density}Â°P</h2>
                        <h2 className='tac'>{beer.attributes.gradation}% VOL</h2>
                        <h2 className='tac'>IBU{beer.attributes.ibu}</h2>
                    </div>

                        <img src={`http://localhost:1337${beer.attributes.cover.data.attributes.formats.small.url}`} alt="" />
                  
                </div>
                <div className="findAdd-menu">
                            <a href="#">
                            <svg width="24" height="24" viewBox="0 0 13 19" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M11.0961 1.98084C9.95966 0.798385 8.44262 0.0959584 6.83778 0.00912976C5.23295 -0.0776989 3.6541 0.457226 2.40595 1.51066C1.15779 2.5641 0.328823 4.06137 0.0790287 5.7135C-0.170766 7.36563 0.176323 9.05549 1.05331 10.457L5.57217 17.6768C5.67274 17.8374 5.81023 17.9694 5.9722 18.0608C6.13417 18.1521 6.31549 18.2 6.49972 18.2C6.68395 18.2 6.86527 18.1521 7.02724 18.0608C7.18921 17.9694 7.32671 17.8374 7.42727 17.6768L11.9463 10.457C12.76 9.1569 13.1196 7.60524 12.9649 6.06206C12.8101 4.51888 12.1503 3.07797 11.0961 1.98084V1.98084ZM10.9442 9.77754L6.49974 16.8782L2.05525 9.77754C0.694808 7.604 0.986593 4.69528 2.74904 2.86097C3.24158 2.34834 3.82632 1.94171 4.46987 1.66428C5.11342 1.38685 5.80317 1.24406 6.49974 1.24406C7.19631 1.24406 7.88607 1.38685 8.52961 1.66428C9.17316 1.94171 9.7579 2.34834 10.2504 2.86097C12.0129 4.69528 12.3046 7.604 10.9442 9.77754Z" fill="black"/>
                            <path d="M6.4999 3.89844C5.98567 3.89844 5.48299 4.05092 5.05542 4.33662C4.62785 4.62231 4.2946 5.02837 4.09782 5.50346C3.90103 5.97855 3.84954 6.50132 3.94986 7.00567C4.05018 7.51002 4.29781 7.9733 4.66143 8.33691C5.02504 8.70053 5.48832 8.94816 5.99267 9.04848C6.49702 9.1488 7.01979 9.09731 7.49488 8.90052C7.96997 8.70373 8.37603 8.37049 8.66172 7.94292C8.94741 7.51535 9.0999 7.01267 9.0999 6.49844C9.09912 5.80911 8.82494 5.14825 8.33751 4.66083C7.85009 4.1734 7.18922 3.89922 6.4999 3.89844V3.89844ZM6.4999 7.79844C6.24279 7.79844 5.99145 7.72219 5.77766 7.57935C5.56388 7.4365 5.39725 7.23347 5.29886 6.99593C5.20047 6.75838 5.17472 6.49699 5.22488 6.24482C5.27504 5.99264 5.39886 5.76101 5.58066 5.5792C5.76247 5.39739 5.99411 5.27358 6.24629 5.22342C6.49846 5.17326 6.75985 5.199 6.99739 5.29739C7.23493 5.39579 7.43797 5.56241 7.58081 5.7762C7.72366 5.98998 7.7999 6.24132 7.7999 6.49844C7.7995 6.8431 7.66241 7.17352 7.4187 7.41724C7.17499 7.66095 6.84456 7.79804 6.4999 7.79844V7.79844Z" fill="black"/>
                            </svg>
                            Mappa</a>

                            <div className='separator'></div>

                            <a href="#"><svg width="28" height="22" viewBox="0 0 25 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M23.9297 0.588235H6.63399C6.50368 0.588235 6.39706 0.694118 6.39706 0.823529V2.47059C6.39706 2.6 6.50368 2.70588 6.63399 2.70588H23.9297C24.06 2.70588 24.1667 2.6 24.1667 2.47059V0.823529C24.1667 0.694118 24.06 0.588235 23.9297 0.588235ZM23.9297 8.94118H6.63399C6.50368 8.94118 6.39706 9.04706 6.39706 9.17647V10.8235C6.39706 10.9529 6.50368 11.0588 6.63399 11.0588H23.9297C24.06 11.0588 24.1667 10.9529 24.1667 10.8235V9.17647C24.1667 9.04706 24.06 8.94118 23.9297 8.94118ZM23.9297 17.2941H6.63399C6.50368 17.2941 6.39706 17.4 6.39706 17.5294V19.1765C6.39706 19.3059 6.50368 19.4118 6.63399 19.4118H23.9297C24.06 19.4118 24.1667 19.3059 24.1667 19.1765V17.5294C24.1667 17.4 24.06 17.2941 23.9297 17.2941ZM0 1.64706C-3.24543e-09 1.86335 0.0428984 2.07753 0.126246 2.27736C0.209593 2.47719 0.331757 2.65876 0.485762 2.81171C0.639768 2.96465 0.822599 3.08597 1.02382 3.16874C1.22504 3.25151 1.4407 3.29412 1.6585 3.29412C1.87629 3.29412 2.09196 3.25151 2.29318 3.16874C2.49439 3.08597 2.67722 2.96465 2.83123 2.81171C2.98524 2.65876 3.1074 2.47719 3.19075 2.27736C3.27409 2.07753 3.31699 1.86335 3.31699 1.64706C3.31699 1.43076 3.27409 1.21659 3.19075 1.01676C3.1074 0.816926 2.98524 0.635356 2.83123 0.482412C2.67722 0.329469 2.49439 0.208147 2.29318 0.125375C2.09196 0.0426023 1.87629 0 1.6585 0C1.4407 0 1.22504 0.0426023 1.02382 0.125375C0.822599 0.208147 0.639768 0.329469 0.485762 0.482412C0.331757 0.635356 0.209593 0.816926 0.126246 1.01676C0.0428984 1.21659 -3.24543e-09 1.43076 0 1.64706ZM0 10C-3.24543e-09 10.2163 0.0428984 10.4305 0.126246 10.6303C0.209593 10.8301 0.331757 11.0117 0.485762 11.1646C0.639768 11.3176 0.822599 11.4389 1.02382 11.5217C1.22504 11.6045 1.4407 11.6471 1.6585 11.6471C1.87629 11.6471 2.09196 11.6045 2.29318 11.5217C2.49439 11.4389 2.67722 11.3176 2.83123 11.1646C2.98524 11.0117 3.1074 10.8301 3.19075 10.6303C3.27409 10.4305 3.31699 10.2163 3.31699 10C3.31699 9.78371 3.27409 9.56953 3.19075 9.3697C3.1074 9.16987 2.98524 8.9883 2.83123 8.83535C2.67722 8.68241 2.49439 8.56109 2.29318 8.47832C2.09196 8.39554 1.87629 8.35294 1.6585 8.35294C1.4407 8.35294 1.22504 8.39554 1.02382 8.47832C0.822599 8.56109 0.639768 8.68241 0.485762 8.83535C0.331757 8.9883 0.209593 9.16987 0.126246 9.3697C0.0428984 9.56953 -3.24543e-09 9.78371 0 10ZM0 18.3529C-3.24543e-09 18.5692 0.0428984 18.7834 0.126246 18.9832C0.209593 19.1831 0.331757 19.3646 0.485762 19.5176C0.639768 19.6705 0.822599 19.7919 1.02382 19.8746C1.22504 19.9574 1.4407 20 1.6585 20C1.87629 20 2.09196 19.9574 2.29318 19.8746C2.49439 19.7919 2.67722 19.6705 2.83123 19.5176C2.98524 19.3646 3.1074 19.1831 3.19075 18.9832C3.27409 18.7834 3.31699 18.5692 3.31699 18.3529C3.31699 18.1366 3.27409 17.9225 3.19075 17.7226C3.1074 17.5228 2.98524 17.3412 2.83123 17.1883C2.67722 17.0354 2.49439 16.914 2.29318 16.8313C2.09196 16.7485 1.87629 16.7059 1.6585 16.7059C1.4407 16.7059 1.22504 16.7485 1.02382 16.8313C0.822599 16.914 0.639768 17.0354 0.485762 17.1883C0.331757 17.3412 0.209593 17.5228 0.126246 17.7226C0.0428984 17.9225 -3.24543e-09 18.1366 0 18.3529Z" fill="black"/>
                            </svg>
                            Salva in lista</a>
                        </div>
                        <hr className="bar"/>
                <h2>Descrizione</h2>
                <p>{beer.attributes.description}</p>
                {/* mappa birrifici che la vendono */}
                <div>
                        <h2>Dove la trovo</h2>
                        {beer.attributes.breweries.data.map(brewery =>
                            <Brewscard key={brewery.id} brewery={brewery}/>
                        )}
                </div>
            </>
            }
        </main>
    )
}